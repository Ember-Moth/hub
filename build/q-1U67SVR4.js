import{u as useLexicalScope,_ as _hW}from"./q-gSxxJeWo.js";import{u as unsubscribe,p as preUnsubscribe,c as queryUserSubscribe,r as resetUserSubscribeToken}from"./q-Dyt3VQLO.js";import{A as API_URL}from"./q-C2B8HMMM.js";import{e as extractDomain,d as universalBase64Encode}from"./q-CsgGrl1E.js";import"./q-BKaOGYNW.js";import"./q-CvYgVdLJ.js";import"./q-B5TFmh5c.js";import"./q-DXZy683x.js";import"./q-CTSOZNae.js";import"./q-BG3_QTyM.js";import"./q-DuNBRwv3.js";import"./q-C_B9_CLk.js";import"./q-CRLhHez8.js";import"./q-Am9eSDJS.js";import"./q-C0whS16-.js";const s_nTc05qFKGSw=async e=>{const[t,s]=useLexicalScope();if(s.loading.update)return!1;s.loading.update=!0;try{return await unsubscribe({id:e}),await t(),!0}catch{return!1}finally{s.loading.update=!1}},subscribe_ts_useSubscribe_handleUnsubscribe_nTc05qFKGSw=Object.freeze(Object.defineProperty({__proto__:null,_hW,s_nTc05qFKGSw},Symbol.toStringTag,{value:"Module"})),s_osaoPAQgIy4=async e=>{const[t]=useLexicalScope();if(t.loading.update)return null;t.loading.update=!0;try{const{data:s}=await preUnsubscribe({id:e});return t.meta.unsubscribe=s.data,s.data}catch{return null}finally{t.loading.update=!1}},s_b8Z6FF4LGTk=async()=>{var t;const[e]=useLexicalScope();if(!(e.loading.list&&e.list.length>0)){e.loading.list=!0;try{const{data:s}=await queryUserSubscribe();e.list=((t=s.data)==null?void 0:t.list)||[],e.list.length>0&&(e.meta.activeIndex<0||e.meta.activeIndex>=e.list.length)&&(e.meta.activeIndex=0)}catch{e.list=[]}finally{e.loading.list=!1}}},s_0SobuyGSWk0=({track:e})=>{const[t]=useLexicalScope();e(()=>t.meta.activeIndex),e(()=>t.list),t.list.length>0&&t.meta.activeIndex>=0&&t.meta.activeIndex<t.list.length?t.selected=t.list[t.meta.activeIndex]:t.selected=null},s_h7EKg4utYFs=(e,t)=>{const[s,n,r]=useLexicalScope();if(!e)return"";const i=(n?n.split(`
`):[extractDomain(API_URL,s)]).map(a=>s?t?`https://${e}.${t}.${a}`:`https://${e}.${a}`:t?`https://${a}${r}?token=${e}&type=${t}`:`https://${a}${r}?token=${e}`),u=Math.floor(Math.random()*i.length);return i[u]},s_e0ItAGwmrJE=async e=>{const[t,s]=useLexicalScope();if(!s.loading.update){s.loading.update=!0;try{await resetUserSubscribeToken({user_subscribe_id:e}),t()}finally{s.loading.update=!1}}},s_GUcdiDfMzZ4=async({track:e})=>{var r;const[t,s]=useLexicalScope();if(e(()=>s.selected),!((r=s.selected)!=null&&r.token)){s.meta.subscribeUrl="";return}const n=await t(s.selected.token);s.meta.subscribeUrl=n},s_GnSgI00mn78=async e=>{var c;const[t,s]=useLexicalScope();if(!((c=s.selected)!=null&&c.token))return"";const n=s.selected.token,r=await t(n,e);return e||(s.meta.subscribeUrl=r),r},s_DnGqTr750tg=(url,schema)=>{const[site_name]=useLexicalScope(),name=site_name||"";if(!schema)return url;try{let result=schema;return result=result.replace(/\${url}/g,url),result=result.replace(/\${name}/g,name),result=result.replace(/\${encodeURIComponent\(([^)]+)\)}/g,(e,t)=>t==="url"?encodeURIComponent(url):t==="name"?encodeURIComponent(name):e),result=result.replace(/\${window\.btoa\(([^)]+)\)}/g,(e,t)=>{const s=typeof window<"u"?window.btoa:universalBase64Encode;return t==="url"?s(url):t==="name"?s(name):e}),result=result.replace(/\${JSON\.stringify\(([^}]+)\)}/g,(match,expr)=>{try{const processedExpr=expr.replace(/url/g,`"${url}"`).replace(/name/g,`"${name}"`);if(processedExpr.includes("server_remote")){const e=`${url}, tag=${name}`;return JSON.stringify({server_remote:[e]})}const result=eval(`(${processedExpr})`);return JSON.stringify(result)}catch{return match}}),result}catch(e){return url}};export{_hW,s_b8Z6FF4LGTk as a,s_0SobuyGSWk0 as b,s_h7EKg4utYFs as c,s_e0ItAGwmrJE as d,s_GUcdiDfMzZ4 as e,s_GnSgI00mn78 as f,s_DnGqTr750tg as g,subscribe_ts_useSubscribe_handleUnsubscribe_nTc05qFKGSw as h,s_osaoPAQgIy4 as s,s_nTc05qFKGSw};
