import{b as k,q as u,u as v,E as C,p as m,t as M,B as R,J as O,e as S,o as w,l as d,m as y,_ as f}from"./q-gSxxJeWo.js";import{_}from"./q-BKaOGYNW.js";import{B as j}from"./q-BG3_QTyM.js";import{L as V,M as x}from"./q-B5TFmh5c.js";import"./q-CvYgVdLJ.js";import{u as z}from"./q-Am9eSDJS.js";import"./q-DuNBRwv3.js";import"./q-C_B9_CLk.js";import"./q-C2B8HMMM.js";import"./q-CRLhHez8.js";import"./q-DXZy683x.js";const A="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",U=1e4,Q=3,D=500;var q=function(e){return e[e.Login=1]="Login",e[e.Register=2]="Register",e[e.ResetPassword=3]="ResetPassword",e}({});const Oe=k(u(()=>_(()=>Promise.resolve().then(()=>K),void 0),"s_0Rh76rd95Gg")),B=()=>{const[e,t]=v();if(!window.turnstile||!t.value){e.updateStatus("error","unavailable");return}e.updateStatus("verifying");try{e.reset(t.value)}catch{e.updateStatus("error","start_failed")}},N=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_z2TWTmFJ7w4:B},Symbol.toStringTag,{value:"Module"})),W=()=>{const[e,t]=v();e.value=0,t.updateStatus("ready","")},$=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_bxQNEtdzLyM:W},Symbol.toStringTag,{value:"Module"})),G=e=>{e&&window.turnstile&&window.turnstile.reset(e)},H=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_j5mw0EB2RmU:G},Symbol.toStringTag,{value:"Module"})),J=e=>{C();const t=z(),r={1:t.config.verify.enable_login_verify,2:t.config.verify.enable_register_verify,3:t.config.verify.enable_reset_password_verify};if(!t.config.verify.turnstile_site_key||!r[e.type])return null;const o=m(),n=m(null),i=m(!1),a=m("loading"),T=m(""),p=m(0),c=m(""),l={reset:u(()=>_(()=>Promise.resolve().then(()=>H),void 0),"s_j5mw0EB2RmU"),remove:u(()=>_(()=>Promise.resolve().then(()=>ce),void 0),"s_6bzkg0mW0OQ"),updateStatus:u(()=>_(()=>Promise.resolve().then(()=>ne),void 0),"s_MHV8LSMwSKg",[T,p,a])},b=u(()=>_(()=>Promise.resolve().then(()=>N),void 0),"s_z2TWTmFJ7w4",[l,n]),P=u(()=>_(()=>Promise.resolve().then(()=>$),void 0),"s_bxQNEtdzLyM",[p,l]),h=u(()=>_(()=>Promise.resolve().then(()=>Y),void 0),"s_3DvyQ1PBUHM",[c,e,p,l]);M(u(()=>_(()=>Promise.resolve().then(()=>ue),void 0),"s_5grNoN9ZktU",[i,a,l,n])),R(u(()=>_(()=>Promise.resolve().then(()=>Z),void 0),"s_MK4UvaS03YQ",[e,i,l,n])),M(u(()=>_(()=>Promise.resolve().then(()=>se),void 0),"s_BCMMVpGh87Y",[o,t,h,c,e,p,i,l,n]));const g=O(u(()=>_(()=>Promise.resolve().then(()=>ie),void 0),"s_XLJhW0n2MMc",[b,P,a])),E={loading:`正在加载验证...`,verifying:`正在验证...`,verified:`验证完成`,ready:`点击以验证您不是机器人`,error:{default:`验证失败`,errors:{unavailable:`验证服务不可用`,start_failed:`启动验证失败`,load_failed:`加载验证服务失败`,timeout:`验证超时`,general:`验证失败`}}},I=O(u(()=>_(()=>Promise.resolve().then(()=>te),void 0),"s_pibPLwRbC5U",[T,a,E]));return S("div",{class:x("relative w-full",e.class)},null,[w(j,{type:"button",onClick$:g.value.onClick,get look(){return g.value.look},class:"w-full",get loading(){return g.value.loading},get disabled(){return g.value.disabled},children:[a.value==="verified"&&w(V,{class:"mr-2 h-4 w-4",[y]:{class:y}},3,"iA_0"),d(s=>s.value,[I])],[y]:{type:y,look:d(s=>s.value.look,[g]),class:y,loading:d(s=>s.value.loading,[g]),disabled:d(s=>s.value.disabled,[g])}},0,"iA_1"),S("div",{ref:o},{class:"invisible h-0",id:d(s=>s.id,[e])},null,3,null),S("input",null,{type:"hidden",name:d(s=>s.name,[e]),value:d((s,L)=>(L.value??"")||s.value,[c,e]),required:d(s=>s.required,[e]),disabled:d(s=>s.disabled,[e]),"aria-hidden":"true"},null,3,null)],1,"iA_2")},K=Object.freeze(Object.defineProperty({__proto__:null,s_0Rh76rd95Gg:J},Symbol.toStringTag,{value:"Module"})),F=e=>{const[t,r,o,n]=v();r.onChange$&&r.onChange$(e),t.value=e,e?(o.value=0,n.updateStatus("verified")):n.updateStatus("ready")},Y=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_3DvyQ1PBUHM:F},Symbol.toStringTag,{value:"Module"})),X=({track:e})=>{const[t,r,o,n]=v(),i=e(()=>t.value??"");r.value&&n.value&&window.turnstile&&i===""&&o.reset(n.value)},Z=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_MK4UvaS03YQ:X},Symbol.toStringTag,{value:"Module"})),ee=()=>{const[e,t,r]=v();if(t.value==="error"){const o=r.error;return e.value&&o.errors&&o.errors[e.value]?o.errors[e.value]:o.default}return r[t.value]},te=Object.freeze(Object.defineProperty({__proto__:null,s_pibPLwRbC5U:ee},Symbol.toStringTag,{value:"Module"})),re=(e,t)=>{const[r,o,n]=v();n.value=e,t!==void 0&&(r.value=t),e==="error"&&o.value<Q&&(o.value++,setTimeout(()=>{n.value==="error"&&(n.value="ready")},2e3))},ne=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_MHV8LSMwSKg:re},Symbol.toStringTag,{value:"Module"})),oe=async({track:e,cleanup:t})=>{const[r,o,n,i,a,T,p,c,l]=v();e(()=>p.value),e(()=>o.config.verify.turnstile_site_key),!(!p.value||!r.value||!window.turnstile)&&(l.value&&(await c.remove(l.value),l.value=null),l.value=window.turnstile.render(r.value,{sitekey:o.config.verify.turnstile_site_key,callback:b=>{n(b),i.value=b,T.value=0},"error-callback":b=>{c.updateStatus("error","general")},"expired-callback":()=>{n(""),i.value="",c.updateStatus("ready")},"timeout-callback":()=>{c.updateStatus("error","timeout")},size:"invisible","response-field":!1,"response-field-name":a.name||"cf-turnstile-response",action:`verify_${q[a.type].toLowerCase()}`}),t(async()=>{l.value&&(await c.remove(l.value),l.value=null)}))},se=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_BCMMVpGh87Y:oe},Symbol.toStringTag,{value:"Module"})),le=()=>{const[e,t,r]=v(),o=r.value==="verified"?"primary":r.value==="error"?"alert":"outline",n=["loading","verifying"].includes(r.value),i=r.value!=="ready"&&r.value!=="error",a=r.value==="error"?t:e;return{look:o,loading:n,disabled:i,onClick:a}},ie=Object.freeze(Object.defineProperty({__proto__:null,s_XLJhW0n2MMc:le},Symbol.toStringTag,{value:"Module"})),ae=()=>{const[e,t,r,o]=v();if(window.turnstile){e.value=!0,t.value="ready";return}const n=document.createElement("script");n.src=A,n.async=!0,n.defer=!0,n.onload=()=>{window.turnstile&&(e.value=!0,t.value="ready")},n.onerror=()=>{r.updateStatus("error","load_failed")},window.onloadTurnstileCallback=()=>{e.value=!0,t.value="ready"},document.body.appendChild(n);const i=setInterval(()=>{window.turnstile&&(e.value=!0,t.value="ready",clearInterval(i))},D),a=setTimeout(()=>{t.value==="loading"&&r.updateStatus("error","timeout")},U);return async()=>{clearTimeout(a),clearInterval(i),await r.remove(o.value),o.value=null}},ue=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_5grNoN9ZktU:ae},Symbol.toStringTag,{value:"Module"})),_e=e=>{e&&window.turnstile&&window.turnstile.remove(e)},ce=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_6bzkg0mW0OQ:_e},Symbol.toStringTag,{value:"Module"}));export{Oe as T,f as _hW,G as a,J as b,F as c,X as d,ee as e,re as f,oe as g,le as h,ae as i,_e as j,W as s,B as s_z2TWTmFJ7w4};
