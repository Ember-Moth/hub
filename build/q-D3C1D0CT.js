import{u as d,D as M,o as f,m as l,l as e,d as _,q as c,h as i,k as q,_hW as v}from"./q-Q7QTf1-t.js";import{s as T,p as x,l as A,r as F,a as I,t as Y,u as K,m as D,b as V,S as R,e as z}from"./q-D0R3-wP7.js";import{C as E,O as U,B}from"./q-CXrtXnGn.js";import{a2 as $,a3 as N,a0 as y,a1 as W}from"./q-D3Ga_9CS.js";import{_ as u}from"./q-BKaOGYNW.js";import"./q-Cfw5b693.js";import{L}from"./q-CX_U-nEJ.js";import{T as J}from"./q-DHhu6Rit.js";import"./q-R_PFgutd.js";import{e as Q}from"./q-CQTmAhrD.js";import{u as G}from"./q-bWKQX6P2.js";import"./q-C6JuRMDH.js";import"./q-B-GNphMI.js";import"./q-DTPKyc3d.js";const H=t=>{const[n]=d();n.internal.fields.telephone_area_code&&(n.internal.fields.telephone_area_code.value=t.callingCode.replace("+",""))},Z=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_DP5UlRbiwxs:H},Symbol.toStringTag,{value:"Module"})),X=t=>{const[n]=d(),a=T(x(I(),F(/^\d+$/,n.code.digitsOnly),A(6,n.code.length)),t||"");return a.success?"":a.issues[0].message},ee=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_vdAdeo9Zn0I:X},Symbol.toStringTag,{value:"Module"})),te=()=>{const[t]=d();t.value="password"},ne=Object.freeze(Object.defineProperty({__proto__:null,s_lpOYqsAtTEk:te},Symbol.toStringTag,{value:"Module"})),oe=async t=>{const[n,a,p]=d();try{switch(n.value=!0,p.value){case"email":await K({email:t.email,password:t.password,cf_token:t.cf_token}).then(r=>{var s;(s=r.data.data)!=null&&s.token&&E(r.data.data.token)});break;case"mobile":await Y({telephone:t.telephone,telephone_area_code:t.telephone_area_code,password:t.password,telephone_code:t.telephone_code,cf_token:t.cf_token}).then(r=>{var s;(s=r.data.data)!=null&&s.token&&E(r.data.data.token)});break}}catch{a.internal.fields.cf_token&&(a.internal.fields.cf_token.value="")}finally{n.value=!1}},ae=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_kHmrbe06Q0w:oe},Symbol.toStringTag,{value:"Module"})),le=()=>{const[t]=d();t.value="code"},re=Object.freeze(Object.defineProperty({__proto__:null,s_MEWU0iJ3Ymk:le},Symbol.toStringTag,{value:"Module"})),se=()=>{const[t]=d();t.value="mobile"},ie=Object.freeze(Object.defineProperty({__proto__:null,s_3TdVWL2u0Hc:se},Symbol.toStringTag,{value:"Module"})),_e=t=>{const[n]=d(),a=T(x(I(),V(6,n.password.minLength),D(20,n.password.maxLength)),t||"");return a.success?"":a.issues[0].message},ce=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_ry4Blfu0hX8:_e},Symbol.toStringTag,{value:"Module"})),ue=t=>{var h;const[n,a]=d(),r=`+${(h=n.internal.fields.telephone_area_code)==null?void 0:h.value}${t}`;return $(r)?N(r)?"":a.telephone.impossible:a.telephone.invalid},de=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_55IrjLIZbY0:ue},Symbol.toStringTag,{value:"Module"})),pe=t=>{const[n]=d();n.value=t},me=Object.freeze(Object.defineProperty({__proto__:null,s_GdY9NScOQpM:pe},Symbol.toStringTag,{value:"Module"})),he=()=>{const[t,n]=d();t.value="email",n.value="password"},be=Object.freeze(Object.defineProperty({__proto__:null,s_ywdl365bbsY:he},Symbol.toStringTag,{value:"Module"}));var k={};const ve=()=>{M();const t=G(),n={email:t.config.auth.email.enable,mobile:t.config.auth.mobile.enable},a=f(n.email?"email":n.mobile?"mobile":"email"),p=f("password"),r=f(!1),[s,{Form:P,Field:h}]=Q({loader:{value:{telephone:"",telephone_area_code:"1",telephone_code:"",email:k.PUBLIC_DEFAULT_USER_EMAIL||"",password:k.PUBLIC_DEFAULT_USER_PASSWORD||"",cf_token:""}}}),j=c(()=>u(()=>Promise.resolve().then(()=>ae),void 0),"s_kHmrbe06Q0w",[r,s,a]),g={email:`无效的电子邮件地址`,telephone:{invalid:`无效的电话号码`,impossible:`电话号码无效`},password:{minLength:`密码至少为6个字符`,maxLength:`密码最多为20个字符`},code:{digitsOnly:`验证码必须仅包含数字`,length:`验证码必须为6位数字`}},b={email:c(()=>u(()=>Promise.resolve().then(()=>ye),void 0),"s_vh2be30rlPY",[g]),telephone:c(()=>u(()=>Promise.resolve().then(()=>de),void 0),"s_55IrjLIZbY0",[s,g]),password:c(()=>u(()=>Promise.resolve().then(()=>ce),void 0),"s_ry4Blfu0hX8",[g]),code:c(()=>u(()=>Promise.resolve().then(()=>ee),void 0),"s_vdAdeo9Zn0I",[g])};return l(P,{onSubmit$:j,class:"w-full",children:[_("div",null,{class:"mb-11 text-center"},[_("h1",null,{class:"mb-3 text-2xl font-bold"},`登录`,1,null),_("p",null,{class:"text-sm"},`您的社交活动`,1,null)],1,null),l(U,null,3,"K6_0"),!n.email&&!n.mobile&&_("div",null,{class:"mb-4 text-center text-red-500"},`没有可用的登录方式`,1,"K6_1"),n.email&&a.value==="email"&&l(h,{name:"email",get validate(){return b.email},children:(o,m)=>l(y,{...m,type:"email",label:`电子邮件`,description:`您的电子邮件地址`,placeholder:`输入您的电子邮件地址`,get value(){return o.value},get error(){return o.error},children:n.mobile&&_("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:c(()=>u(()=>Promise.resolve().then(()=>ie),void 0),"s_3TdVWL2u0Hc",[a])},`切换到电话号码`,1,"K6_2"),[e]:{type:e,value:i(o,"value"),error:i(o,"error")}},0,"K6_3"),[e]:{name:e,validate:i(b,"email")}},3,"K6_4"),n.mobile&&a.value==="mobile"&&l(h,{name:"telephone",get validate(){return b.telephone},children:(o,m)=>l(y,{...m,type:"tel",label:`电话号码`,description:`您的电话号码`,placeholder:`输入您的电话号码`,get value(){return o.value},get error(){return o.error},children:[_("div",{"q:slot":"prefix"},null,l(W,{onChange$:c(()=>u(()=>Promise.resolve().then(()=>Z),void 0),"s_DP5UlRbiwxs",[s])},2,"K6_5"),1,null),p.value==="password"&&n.email&&_("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:c(()=>u(()=>Promise.resolve().then(()=>be),void 0),"s_ywdl365bbsY",[a,p])},`切换到电子邮件`,1,"K6_6")],[e]:{type:e,value:i(o,"value"),error:i(o,"error")}},0,"K6_7"),[e]:{name:e,validate:i(b,"telephone")}},3,"K6_8"),p.value==="password"&&l(h,{name:"password",get validate(){return b.password},children:(o,m)=>l(y,{...m,type:"password",label:`密码`,description:`您的密码`,placeholder:`输入您的密码`,get value(){return o.value},get error(){return o.error},children:a.value==="mobile"&&_("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:c(()=>u(()=>Promise.resolve().then(()=>re),void 0),"s_MEWU0iJ3Ymk",[p])},`切换到验证码`,1,"K6_9"),[e]:{type:e,value:i(o,"value"),error:i(o,"error")}},0,"K6_10"),[e]:{name:e,validate:i(b,"password")}},3,"K6_11"),p.value==="code"&&l(h,{name:"telephone_code",get validate(){return b.code},children:(o,m)=>{var w,S,O;return l(y,{...m,type:"text",label:`验证码`,description:`6位数字代码`,placeholder:`输入验证码`,get value(){return o.value},get error(){return o.error},children:[_("div",{"q:slot":"suffix"},null,l(R,{get type(){return a.value},params:{email:(w=s.internal.fields.email)==null?void 0:w.value,telephone:(S=s.internal.fields.telephone)==null?void 0:S.value,telephone_area_code:(O=s.internal.fields.telephone_area_code)==null?void 0:O.value,type:2},[e]:{type:q(C=>C.value,[a])}},3,"K6_12"),1,null),_("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:c(()=>u(()=>Promise.resolve().then(()=>ne),void 0),"s_lpOYqsAtTEk",[p])},`切换到密码`,1,null)],[e]:{type:e,value:i(o,"value"),error:i(o,"error")}},0,"K6_13")},[e]:{name:e,validate:i(b,"code")}},3,"K6_14"),_("div",null,{class:"mb-6 flex justify-end text-sm font-semibold"},l(L,{href:"/account/forgot-password",class:"text-primary hover:underline",children:`忘记密码？`,[e]:{href:e,class:e}},1,"K6_15"),1,null),l(h,{name:"cf_token",children:(o,m)=>l(J,{...m,type:1,get value(){return o.value},onChange$:c(()=>u(()=>Promise.resolve().then(()=>me),void 0),"s_GdY9NScOQpM",[o]),class:"mb-6",[e]:{type:e,value:i(o,"value"),class:e}},0,"K6_16"),[e]:{name:e}},3,"K6_17"),l(B,{type:"submit",get loading(){return r.value},class:"bg-primary mb-6 w-full",children:`登录`,[e]:{type:e,loading:q(o=>o.value,[r]),class:e}},1,"K6_18"),_("p",null,{class:"text-center text-sm text-zinc-500"},[`还不是会员？`," ",l(L,{href:"/account/sign-up",class:"text-primary hover:underline",children:`注册`,[e]:{href:e,class:e}},1,"K6_19")],1,null)],[e]:{onSubmit$:e,class:e}},1,"K6_20")},Me=Object.freeze(Object.defineProperty({__proto__:null,s_BDJyJnGNA9o:ve},Symbol.toStringTag,{value:"Module"})),ge=t=>{const[n]=d(),a=T(x(I(),z(n.email)),t||"");return a.success?"":a.issues[0].message},ye=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_vh2be30rlPY:ge},Symbol.toStringTag,{value:"Module"}));export{v as _hW,Me as i,se as s_3TdVWL2u0Hc,ue as s_55IrjLIZbY0,ve as s_BDJyJnGNA9o,H as s_DP5UlRbiwxs,pe as s_GdY9NScOQpM,le as s_MEWU0iJ3Ymk,oe as s_kHmrbe06Q0w,te as s_lpOYqsAtTEk,_e as s_ry4Blfu0hX8,X as s_vdAdeo9Zn0I,ge as s_vh2be30rlPY,he as s_ywdl365bbsY};
