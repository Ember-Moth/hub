import{u as m,D as U,o as k,A as z,q as u,m as r,l as e,d as h,h as s,k as F,_hW as f}from"./q-Q7QTf1-t.js";import{s as I,p as S,e as Y,a as O,c as B,d as Q,l as G,r as $,S as W,m as H,b as K}from"./q-D0R3-wP7.js";import{C as j,O as N,B as X}from"./q-CXrtXnGn.js";import{f as J,e as Z}from"./q-CQTmAhrD.js";import{a2 as ee,a3 as te,a0 as T,a1 as ne}from"./q-D3Ga_9CS.js";import{_ as d}from"./q-BKaOGYNW.js";import"./q-Cfw5b693.js";import{L as ae}from"./q-CX_U-nEJ.js";import{T as oe}from"./q-DHhu6Rit.js";import"./q-R_PFgutd.js";import{u as re}from"./q-bWKQX6P2.js";import"./q-C6JuRMDH.js";import"./q-B-GNphMI.js";import"./q-DTPKyc3d.js";const se=()=>{const[n]=m();n.value="mobile"},le=Object.freeze(Object.defineProperty({__proto__:null,s_16PtgeReVRQ:se},Symbol.toStringTag,{value:"Module"})),ie=n=>{const[a,o]=m();if(!n)return o.email.invalid;const g=I(S(O(),Y(o.email.invalid)),n||"");if(!g.success)return g.issues[0].message;if(a.restrictions.emailDomainWhitelist.enabled){const l=n.split("@")[1],c=a.restrictions.emailDomainWhitelist.domains;if(c.length>0&&!c.includes(l))return o.email.domainNotAllowed}return""},_e=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_GxXnEK0wRh4:ie},Symbol.toStringTag,{value:"Module"})),ce=n=>{var l;const[a,o]=m(),g=(l=a.internal.fields.password)==null?void 0:l.value;return n!==g?o.password.mismatch:""},ue=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_p0P2HFciSSU:ce},Symbol.toStringTag,{value:"Module"})),de=async n=>{const[a,o,g]=m();try{switch(a.value=!0,g.value){case"email":await Q({email:n.email,password:n.password,invite:n.invite,code:n.code,cf_token:n.cf_token}).then(l=>{var c;(c=l.data.data)!=null&&c.token&&j(l.data.data.token)});break;case"mobile":await B({telephone:n.telephone,telephone_area_code:n.telephone_area_code,password:n.password,invite:n.invite,code:n.code,cf_token:n.cf_token}).then(l=>{var c;(c=l.data.data)!=null&&c.token&&j(l.data.data.token)});break}}catch{o.internal.fields.cf_token&&(o.internal.fields.cf_token.value="")}finally{a.value=!1}},me=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_mib3t7GZk1c:de},Symbol.toStringTag,{value:"Module"})),pe=()=>{const[n]=m();setTimeout(()=>{const o=new URLSearchParams(window.location.search).get("ref");o&&(J(n,"invite",o),localStorage.setItem("invite_code",o))},0)},he=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_vKr7YEBz0lg:pe},Symbol.toStringTag,{value:"Module"})),ge=()=>{const[n]=m();n.value="email"},ve=Object.freeze(Object.defineProperty({__proto__:null,s_WMGQ0TY6tHA:ge},Symbol.toStringTag,{value:"Module"})),be=n=>{var x;const[a,o]=m(),l=`+${(x=a.internal.fields.telephone_area_code)==null?void 0:x.value}${n}`;return ee(l)?te(l)?"":o.telephone.impossible:o.telephone.invalid},fe=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_rRMUyRt0snY:be},Symbol.toStringTag,{value:"Module"})),ye=n=>{const[a]=m(),o=I(S(O(),$(/^\d+$/,a.code.digitsOnly),G(6,a.code.length)),n||"");return o.success?"":o.issues[0].message},Te=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_C0Byk9sFwXc:ye},Symbol.toStringTag,{value:"Module"})),we=()=>{U();const n=re(),{auth:{register:{stop_register:a},email:{enable:o,enable_verify:g,enable_domain_suffix:l,domain_suffix_list:c},mobile:{enable:q,enable_whitelist:x,whitelist:M}},invite:{forced_invite:L}}=n.config,i={methods:{email:o,mobile:q},restrictions:{forceInvite:L,disabled:a,emailVerification:g,emailDomainWhitelist:{enabled:l,domains:c.split(`
`).map(t=>t.trim())},mobileWhitelist:{enabled:x,numbers:M}}},v=k(i.methods.email?"email":i.methods.mobile?"mobile":"email"),P=k(!1),[b,{Form:V,Field:y}]=Z({loader:{value:{telephone_area_code:"1",telephone:"",email:"",password:"",repeat_password:"",code:"",invite:"",cf_token:""}}}),A=u(()=>d(()=>Promise.resolve().then(()=>me),void 0),"s_mib3t7GZk1c",[P,b,v]),w={email:{invalid:`无效的电子邮件地址`,domainNotAllowed:`不允许使用该电子邮件域名`},telephone:{invalid:`无效的电话号码`,impossible:`电话号码无效`},password:{minLength:`密码至少为6个字符`,maxLength:`密码最多为20个字符`,mismatch:`密码不匹配`},code:{digitsOnly:`验证码必须仅包含数字`,length:`验证码必须为6位数字`}},p={email:u(()=>d(()=>Promise.resolve().then(()=>_e),void 0),"s_GxXnEK0wRh4",[i,w]),telephone:u(()=>d(()=>Promise.resolve().then(()=>fe),void 0),"s_rRMUyRt0snY",[b,w]),password:u(()=>d(()=>Promise.resolve().then(()=>Se),void 0),"s_DUgy4npUTq8",[w]),repeatPassword:u(()=>d(()=>Promise.resolve().then(()=>ue),void 0),"s_p0P2HFciSSU",[b,w]),code:u(()=>d(()=>Promise.resolve().then(()=>Te),void 0),"s_C0Byk9sFwXc",[w])};return z(u(()=>d(()=>Promise.resolve().then(()=>he),void 0),"s_vKr7YEBz0lg",[b])),r(V,{onSubmit$:A,class:"w-full",children:[h("div",null,{class:"mb-11 text-center"},[h("h1",null,{class:"mb-3 text-2xl font-bold"},`注册`,1,null),h("p",null,{class:"text-sm"},`您的社交活动`,1,null)],1,null),r(N,null,3,"8g_0"),i.restrictions.disabled&&h("div",null,{class:"mb-4 text-center text-red-500"},`当前注册已禁用`,1,"8g_1"),!i.methods.email&&!i.methods.mobile&&h("div",null,{class:"mb-4 text-center text-red-500"},`没有可用的注册方式`,1,"8g_2"),i.methods.email&&v.value==="email"&&r(y,{name:"email",get validate(){return p.email},children:(t,_)=>r(T,{..._,type:"email",label:`电子邮件`,description:`您的电子邮件地址`,placeholder:`输入您的电子邮件地址`,get value(){return t.value},get error(){return t.error},children:i.methods.mobile&&h("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:u(()=>d(()=>Promise.resolve().then(()=>le),void 0),"s_16PtgeReVRQ",[v])},`切换到电话号码`,1,"8g_3"),[e]:{type:e,value:s(t,"value"),error:s(t,"error")}},0,"8g_4"),[e]:{name:e,validate:s(p,"email")}},3,"8g_5"),i.methods.mobile&&v.value==="mobile"&&r(y,{name:"telephone",get validate(){return p.telephone},children:(t,_)=>r(T,{..._,type:"tel",label:`电话号码`,description:`您的电话号码`,placeholder:`输入您的电话号码`,get value(){return t.value},get error(){return t.error},children:[h("div",{"q:slot":"prefix"},null,r(ne,{onChange$:u(()=>d(()=>Promise.resolve().then(()=>qe),void 0),"s_cBJVO0QRC7w",[b])},2,"8g_6"),1,null),i.methods.email&&h("button",{"q:slot":"extra"},{class:"text-primary cursor-pointer text-sm hover:underline",type:"button",onClick$:u(()=>d(()=>Promise.resolve().then(()=>ve),void 0),"s_WMGQ0TY6tHA",[v])},`切换到电子邮件`,1,"8g_7")],[e]:{type:e,value:s(t,"value"),error:s(t,"error")}},0,"8g_8"),[e]:{name:e,validate:s(p,"telephone")}},3,"8g_9"),(v.value==="email"&&i.restrictions.emailVerification||v.value==="mobile")&&r(y,{name:"code",get validate(){return p.code},children:(t,_)=>{var E,R,C;return r(T,{..._,type:"text",placeholder:`输入验证码`,get value(){return t.value},get error(){return t.error},children:h("div",{"q:slot":"suffix"},null,r(W,{get type(){return v.value},params:{email:(E=b.internal.fields.email)==null?void 0:E.value,telephone:(R=b.internal.fields.telephone)==null?void 0:R.value,telephone_area_code:(C=b.internal.fields.telephone_area_code)==null?void 0:C.value,type:1},[e]:{type:F(D=>D.value,[v])}},3,"8g_10"),1,null),[e]:{type:e,value:s(t,"value"),error:s(t,"error")}},0,"8g_11")},[e]:{name:e,validate:s(p,"code")}},3,"8g_12"),r(y,{name:"password",get validate(){return p.password},children:(t,_)=>r(T,{..._,type:"password",autoComplete:"off",placeholder:`输入您的密码`,get value(){return t.value},get error(){return t.error},[e]:{type:e,autoComplete:e,value:s(t,"value"),error:s(t,"error")}},0,"8g_13"),[e]:{name:e,validate:s(p,"password")}},3,"8g_14"),r(y,{name:"repeat_password",get validate(){return p.repeatPassword},children:(t,_)=>r(T,{..._,type:"password",autoComplete:"off",placeholder:`确认您的密码`,get value(){return t.value},get error(){return t.error},[e]:{type:e,autoComplete:e,value:s(t,"value"),error:s(t,"error")}},0,"8g_15"),[e]:{name:e,validate:s(p,"repeatPassword")}},3,"8g_16"),r(y,{name:"invite",children:(t,_)=>r(T,{..._,type:"text",placeholder:`输入您的邀请码 ${i.restrictions.forceInvite?"":`(${`可选`})`}`,get value(){return t.value},get error(){return t.error},get required(){return i.restrictions.forceInvite},[e]:{type:e,value:s(t,"value"),error:s(t,"error"),required:s(i.restrictions,"forceInvite")}},0,"8g_17"),[e]:{name:e}},3,"8g_18"),r(y,{name:"cf_token",children:(t,_)=>r(oe,{..._,type:2,get value(){return t.value},onChange$:u(()=>d(()=>Promise.resolve().then(()=>Pe),void 0),"s_n7FL31s0y6Y",[t]),class:"mb-6",[e]:{type:e,value:s(t,"value"),class:e}},0,"8g_19"),[e]:{name:e}},3,"8g_20"),r(X,{type:"submit",get loading(){return P.value},class:"bg-primary mb-6 w-full",get disabled(){return i.restrictions.disabled},children:`注册`,[e]:{type:e,loading:F(t=>t.value,[P]),class:e,disabled:s(i.restrictions,"disabled")}},1,"8g_21"),h("p",null,{class:"text-center text-sm text-zinc-500"},[`已经是会员？`," ",r(ae,{href:"/account/sign-in",class:"text-primary hover:underline",children:`登录`,[e]:{href:e,class:e}},1,"8g_22")],1,null)],[e]:{onSubmit$:e,class:e}},1,"8g_23")},Be=Object.freeze(Object.defineProperty({__proto__:null,s_5MFvn3RwlIQ:we},Symbol.toStringTag,{value:"Module"})),xe=n=>{const[a]=m();a.value=n},Pe=Object.freeze(Object.defineProperty({__proto__:null,s_n7FL31s0y6Y:xe},Symbol.toStringTag,{value:"Module"})),Ie=n=>{const[a]=m(),o=I(S(O(),K(6,a.password.minLength),H(20,a.password.maxLength)),n||"");return o.success?"":o.issues[0].message},Se=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_DUgy4npUTq8:Ie},Symbol.toStringTag,{value:"Module"})),Oe=n=>{const[a]=m();a.internal.fields.telephone_area_code&&(a.internal.fields.telephone_area_code.value=n.callingCode.replace("+",""))},qe=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_cBJVO0QRC7w:Oe},Symbol.toStringTag,{value:"Module"}));export{f as _hW,Be as i,se as s_16PtgeReVRQ,we as s_5MFvn3RwlIQ,ye as s_C0Byk9sFwXc,Ie as s_DUgy4npUTq8,ie as s_GxXnEK0wRh4,ge as s_WMGQ0TY6tHA,Oe as s_cBJVO0QRC7w,de as s_mib3t7GZk1c,xe as s_n7FL31s0y6Y,ce as s_p0P2HFciSSU,be as s_rRMUyRt0snY,pe as s_vKr7YEBz0lg};
