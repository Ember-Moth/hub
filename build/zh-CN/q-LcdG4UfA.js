import{u as o,_ as f}from"./q-gSxxJeWo.js";import{r as l}from"./q-BG3_QTyM.js";import"./q-BKaOGYNW.js";import"./q-DuNBRwv3.js";import"./q-B5TFmh5c.js";import"./q-CvYgVdLJ.js";import"./q-C_B9_CLk.js";import"./q-C2B8HMMM.js";import"./q-CRLhHez8.js";import"./q-DXZy683x.js";import"./q-Am9eSDJS.js";async function g(e,t){return l("/v1/public/ticket/",{method:"PUT",headers:{"Content-Type":"application/json"},data:e})}async function h(e,t){return l("/v1/public/ticket/",{method:"POST",headers:{"Content-Type":"application/json"},data:e})}async function y(e,t){return l("/v1/public/ticket/detail",{method:"GET",params:{...e}})}async function k(e,t){return l("/v1/public/ticket/follow",{method:"POST",headers:{"Content-Type":"application/json"},data:e})}async function _(e,t){return l("/v1/public/ticket/list",{method:"GET",params:{...e}})}const T=async e=>{const[t,i]=o();if(i.loading.update)return null;i.loading.update=!0;try{const n=await k(e);return i.selected&&i.selected.id===e.ticket_id&&await t(),n}catch{return null}finally{i.loading={...i.loading,update:!1}}},I=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_ehYpNb4GCg8:T},Symbol.toStringTag,{value:"Module"})),N=async e=>{const[t,i,n]=o();if(n.loading.update)return null;n.loading.update=!0;try{const a=await g(e);return n.selected&&n.selected.id===e.id&&await t(),await i(),a}catch{return null}finally{n.loading.update=!1}},O=({track:e,cleanup:t})=>{var d;const[i,n]=o(),a=e(()=>n.selected),s=e(()=>n.meta.chat);let r=null;const c=()=>{r&&(clearInterval(r),r=null)},p=()=>{c(),s&&(a!=null&&a.id)&&(i(),r=setInterval(()=>{var u;if(((u=n.detail)==null?void 0:u.status)===4){c();return}i()},5e3))};a!=null&&a.id&&((d=n.detail)==null?void 0:d.id)!==a.id&&(n.detail=null,i()),s&&(a!=null&&a.id)?p():c(),t(()=>{c()})},G=async e=>{const[t,i]=o();if(i.loading.create)return null;i.loading.create=!0;try{const n=await h(e);return await t(),n}catch{return null}finally{i.loading.create=!1}},L=async e=>{var n;const[t]=o(),i=e||((n=t.selected)==null?void 0:n.id);if(!(!i||t.loading.detail)){t.loading.detail=!0;try{const{data:a}=await y({id:Number(i)});t.detail=a.data||null}catch{t.detail=null}finally{t.loading.detail=!1}}},M=async e=>{const[t]=o();if(!t.loading.list){t.loading.list=!0;try{const{data:i}=await _({page:(e==null?void 0:e.page)||t.params.page,size:(e==null?void 0:e.size)||t.params.size,...e||{}});i.data&&(t.list=i.data.list||[],t.pagination.total=i.data.total||0,t.pagination.current=(e==null?void 0:e.page)||t.params.page||1,t.pagination.size=(e==null?void 0:e.size)||t.params.size||10,t.pagination.hasMore=t.pagination.total>t.pagination.current*t.pagination.size,t.params={...t.params,...e||{}})}catch{t.list=[]}finally{t.loading.list=!1}}};export{f as _hW,O as a,G as b,L as c,M as d,N as s,T as s_ehYpNb4GCg8,I as t};
