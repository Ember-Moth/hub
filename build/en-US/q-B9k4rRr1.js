import{v as z,x as Q,c as N,a as Y,B as F,q as u,u as m,b as I,E as Z,p as A,J as j,e as b,o as a,l as y,F as M,m as o,i as g,_ as f}from"./q-gSxxJeWo.js";import{s as R,p as V,m as k,b as H,a as D,e as G}from"./q-BHN7C-TJ.js";import{_}from"./q-BKaOGYNW.js";import{O as $,S as X,B as W}from"./q-BG3_QTyM.js";import"./q-B5TFmh5c.js";import{a0 as x}from"./q-DuNBRwv3.js";import{L as K}from"./q-BKzbtE2O.js";import{u as J,O as ee}from"./q-BROdRmjX.js";import"./q-CvYgVdLJ.js";import{e as te,h as oe}from"./q-BMQMcSac.js";import{u as re}from"./q-Am9eSDJS.js";import{D as ne}from"./q-C0whS16-.js";import{u as se}from"./q-CTSOZNae.js";import"./q-C_B9_CLk.js";import"./q-BQapYjCx.js";import"./q-C2B8HMMM.js";import"./q-CRLhHez8.js";import"./q-DXZy683x.js";const ae={...ne,selected:{}},B=N("subscription-store"),tt=e=>{const t={...ae,...e},n=z(t);return Q(B,n),n},ie=()=>{const e=Y(B),t=u(()=>_(()=>import("./q-DzFXuKop.js"),[]),"s_FZjXpimr7d8",[e]);return F(u(()=>_(()=>import("./q-DmBfbu57.js").then(n=>n.a),[]),"s_G22pSUr0YFM",[e])),{subscriptionStore:e,fetchSubscriptionList:t}},le=()=>{const[e,t]=m();if(e.value===4)return[{quantity:1,discount:0}];const n=[{quantity:1,discount:0}];return t.subscriptionStore.detail?n.concat(t.subscriptionStore.detail.discount.map(s=>({quantity:s.quantity,discount:s.discount}))):n},ue=Object.freeze(Object.defineProperty({__proto__:null,s_SRzq4onWrBM:le},Symbol.toStringTag,{value:"Module"})),_e=()=>{const[e,t]=m();t(e.value)},de=Object.freeze(Object.defineProperty({__proto__:null,s_Z5aBAqv4iT0:_e},Symbol.toStringTag,{value:"Module"})),ce=async()=>{const[e,t,n,s,d]=m();s.value=new URLSearchParams(window.location.search);const i=Number(s.value.get("id")||0);d.subscriptionStore.list.length===0&&await d.fetchSubscriptionList(),i&&n.value!==4&&(d.subscriptionStore.selected={id:i},e()),setTimeout(()=>{t.value=!1},500)},me=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_TLEV4KZHtUQ:ce},Symbol.toStringTag,{value:"Module"})),pe=()=>{var t;const[e]=m();return Number(((t=e.value)==null?void 0:t.get("type"))||1)},ve=Object.freeze(Object.defineProperty({__proto__:null,s_5F5mcYnOO14:pe},Symbol.toStringTag,{value:"Module"})),be=(e,t)=>{const[n]=m();n.value=t.value},he=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_cPYvI8VTAmA:be},Symbol.toStringTag,{value:"Module"})),ye=e=>{const[t]=m();if(!e||e.trim()==="")return"";const n=R(V(D(),H(6,t.password.minLength),k(20,t.password.maxLength)),e);return n.success?"":n.issues[0].message},ge=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_1RulbejlHoM:ye},Symbol.toStringTag,{value:"Module"})),fe=()=>{const[e,t]=m();t.email(e.value)},Se=Object.freeze(Object.defineProperty({__proto__:null,s_G5SBf6nMUoM:fe},Symbol.toStringTag,{value:"Module"})),Te=e=>{const[t,n]=m();if(t.userStore.meta.authenticated)return"";const s=R(V(D(),G(n.email)),e||"");return s.success?"":s.issues[0].message},Pe=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_XTCGplgD2IY:Te},Symbol.toStringTag,{value:"Module"})),Oe=e=>{var d;const[t,n,s]=m();t.value=e,n((d=s.internal.fields.coupon)==null?void 0:d.value)},xe=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_ssmNrvI00o8:Oe},Symbol.toStringTag,{value:"Module"})),Ie=e=>{const[t]=m();t.value=e},Ee=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_en3baesFiZ0:Ie},Symbol.toStringTag,{value:"Module"})),we=I(u(()=>_(()=>import("./q-DbrLfVit.js"),[]),"s_jZPZx0c087w")),qe=I(u(()=>_(()=>import("./q-1wghvy7I.js"),[]),"s_0QfjK1daSeY")),Ce=I(u(()=>_(()=>import("./q-CubOB4IE.js"),[]),"s_RMC9nqtoJ00")),ot=()=>{var q,C,L;Z();const t=re().config.site.site_name,n=A(!0),s=se(),d=A(null),i=j(u(()=>_(()=>Promise.resolve().then(()=>ve),void 0),"s_5F5mcYnOO14",[d])),p=ie(),c=J(),h={email:`Invalid email address format`,password:{optional:`If you don't set a password, the system will automatically generate one and send it to your email`,minLength:`Password must be at least 6 characters`,maxLength:`Password must be at most 20 characters`}},[v,{Form:E,Field:S}]=te({loader:{value:{auth_type:void 0,identifier:void 0,password:void 0,payment:void 0,subscribe_id:void 0,quantity:void 0,coupon:void 0,turnstile_token:void 0,amount:1e3,invite_code:void 0}}}),T={email:u(()=>_(()=>Promise.resolve().then(()=>Pe),void 0),"s_XTCGplgD2IY",[s,h]),password:u(()=>_(()=>Promise.resolve().then(()=>ge),void 0),"s_1RulbejlHoM",[h])},O=u(()=>_(()=>Promise.resolve().then(()=>Re),void 0),"s_pdqicBscScg",[c,v,i,d]),U=u(()=>_(()=>Promise.resolve().then(()=>Me),void 0),"s_uLfXH3VrssU",[c,i,d]);F(u(()=>_(()=>Promise.resolve().then(()=>me),void 0),"s_TLEV4KZHtUQ",[O,n,i,d,p]));const w=j(u(()=>_(()=>Promise.resolve().then(()=>ue),void 0),"s_SRzq4onWrBM",[i,p]));return b("div",null,{class:"container pb-20 md:pb-6"},[n.value&&a(K,null,3,"oC_0"),b("section",null,{class:"my-8 text-center md:mb-12 md:text-left"},s.userStore.meta.authenticated?a(M,{children:[b("h2",null,{class:"text-xl font-semibold"},`Create Order`,1,null),b("p",null,{class:"text-sm text-zinc-400"},[`Current Account`,":"," ",y(r=>{var l;return(l=r.userStore.detail)==null?void 0:l.auth_methods[0].auth_identifier},[s])],1,null)]},1,"oC_2"):b("h2",null,{class:"text-xl font-semibold"},`Enter the email address you want to use for your ${t} account`,1,"oC_1"),1,null),b("section",null,{class:"flex flex-col md:flex-row"},[b("div",null,{class:"mb-4 w-full flex-auto md:mr-8 md:mb-0 md:basis-3xl lg:min-h-[calc(100vh-120px)]"},a(E,{onSubmit$:U,class:"w-full",children:[!s.userStore.meta.authenticated&&b("div",null,{class:"mb-8"},[a(S,{name:"identifier",get validate(){return T.email},validateOn:"change",children:(r,l)=>a(x,{...l,type:"email",placeholder:`Enter your email address`,get value(){return r.value},get error(){return r.error},onBlur$:u(()=>_(()=>Promise.resolve().then(()=>Se),void 0),"s_G5SBf6nMUoM",[r,T]),[o]:{type:o,value:g(r,"value"),error:g(r,"error")}},0,"oC_3"),[o]:{name:o,validate:g(T,"email"),validateOn:o}},3,"oC_4"),a(S,{name:"password",get validate(){return T.password},children:(r,l)=>a(x,{...l,type:"password",placeholder:`Your account password (optional)`,get value(){return r.value},error:r.error||" "+h.password.optional,[o]:{type:o,value:g(r,"value")}},0,"oC_5"),[o]:{name:o,validate:g(T,"password")}},3,"oC_6"),b("div",null,{class:"flex flex-col-reverse"},a($,null,3,"oC_7"),1,null),b("p",null,{class:"text-sm text-zinc-400"},`We do not share your email address with any third parties and only contact you when necessary to ensure service quality or for notifications.`,1,null)],1,"oC_8"),s.userStore.meta.authenticated&&i.value===2&&a(S,{name:"quantity",type:"number",children:r=>a(Ce,{get value(){return r.value},get options(){return w.value},get unitTime(){var l;return(l=p.subscriptionStore.detail)==null?void 0:l.unit_time},onQuantityChange$:u(()=>_(()=>Promise.resolve().then(()=>xe),void 0),"s_ssmNrvI00o8",[r,O,v]),[o]:{value:g(r,"value"),options:y(l=>l.value,[w]),unitTime:y(l=>{var P;return(P=l.subscriptionStore.detail)==null?void 0:P.unit_time},[p])}},2,"oC_9"),[o]:{name:o,type:o}},3,"oC_10"),s.userStore.meta.authenticated&&i.value===4&&a(S,{name:"amount",type:"number",children:r=>a(we,{get value(){return r.value},get loading(){return c.orderStore.loading.create},onAmountChange$:u(()=>_(()=>Promise.resolve().then(()=>Ee),void 0),"s_en3baesFiZ0",[r]),[o]:{value:g(r,"value"),loading:y(l=>l.orderStore.loading.create,[c])}},2,"oC_11"),[o]:{name:o,type:o}},3,"oC_12"),a(S,{name:"payment",type:"number",children:r=>a(qe,{get loading(){return c.orderStore.loading.create},get hideBalance(){return!s.userStore.meta.authenticated||i.value===4},onPaymentMethodSelect$:u(()=>_(()=>Promise.resolve().then(()=>Ae),void 0),"s_PUc39QTQbbk",[r,v]),[o]:{loading:y(l=>l.orderStore.loading.create,[c]),hideBalance:y((l,P)=>!P.userStore.meta.authenticated||l.value===4,[i,s])}},3,"oC_13"),[o]:{name:o,type:o}},3,"oC_14")],[o]:{onSubmit$:o,class:o}},1,"oC_15"),1,null),a(ee,{get previewOrder(){return c.orderStore.meta.pre},get product(){return p.subscriptionStore.detail},config:{type:i.value,quantity:i.value===2?Number(((q=v.internal.fields.quantity)==null?void 0:q.value)||1):Number(((C=d.value)==null?void 0:C.get("frequency"))||1),amount:i.value===4?Number(((L=v.internal.fields.amount)==null?void 0:L.value)||0):void 0},children:[1,2].includes(i.value)&&a(M,{children:[a(X,{class:"my-4",[o]:{class:o}},3,"oC_16"),a(S,{name:"coupon",children:r=>a(x,{ghost:!0,type:"text",placeholder:`Enter coupon code`,class:"w-full",get value(){return r.value},onInput$:u(()=>_(()=>Promise.resolve().then(()=>he),void 0),"s_cPYvI8VTAmA",[r]),children:b("div",{"q:slot":"suffix"},null,a(W,{class:"h-full border-0 whitespace-nowrap shadow-none",onClick$:u(()=>_(()=>Promise.resolve().then(()=>de),void 0),"s_Z5aBAqv4iT0",[r,O]),children:`Apply`,[o]:{class:o}},1,"oC_17"),1,null),[o]:{ghost:o,type:o,class:o,value:g(r,"value")}},0,"oC_18"),[o]:{name:o}},3,"oC_19")]},1,"oC_20"),[o]:{previewOrder:y(r=>r.orderStore.meta.pre,[c]),product:y(r=>r.subscriptionStore.detail,[p])}},1,"oC_21")],1,null)],1,"oC_22")},Le=e=>{const[t,n]=m();t.value=e,oe(n)},Ae=Object.freeze(Object.defineProperty({__proto__:null,s_PUc39QTQbbk:Le},Symbol.toStringTag,{value:"Module"})),je=async e=>{var c,h,v;const[t,n,s]=m(),d=Number(((c=s.value)==null?void 0:c.get("id"))||0),i=Number(((h=s.value)==null?void 0:h.get("frequency"))||1),p=Number(((v=s.value)==null?void 0:v.get("subscribe_id"))||0);switch(n.value){case 2:t.handleRenewal({user_subscribe_id:p,payment:e.payment,quantity:e.quantity||1,coupon:e.coupon});return;case 3:t.handleResetTraffic({user_subscribe_id:p,payment:e.payment});return;case 4:t.handleRecharge({amount:e.amount,payment:e.payment});return;default:t.handlePurchase({auth_type:"email",identifier:e.identifier,password:e.password,payment:e.payment,subscribe_id:d,quantity:i||1,coupon:e.coupon,turnstile_token:"",invite_code:localStorage.getItem("invite_code")||void 0});return}},Me=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_uLfXH3VrssU:je},Symbol.toStringTag,{value:"Module"})),Fe=e=>{var c,h,v;const[t,n,s,d]=m();if([3,4].includes(s.value))return;const i=Number(((c=d.value)==null?void 0:c.get("id"))||0),p=Number(((h=d.value)==null?void 0:h.get("frequency"))||1);try{t.handlePrePurchase({payment:-1,subscribe_id:i,quantity:s.value===2?Number(((v=n.internal.fields.quantity)==null?void 0:v.value)||1):p,coupon:e})}catch{n.internal.fields.coupon.value=""}},Re=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_pdqicBscScg:Fe},Symbol.toStringTag,{value:"Module"}));export{ie as a,ce as b,pe as c,be as d,ye as e,fe as f,Te as g,Oe as h,Ie as i,ot as j,Le as k,je as l,Fe as m,_e as s,le as s_SRzq4onWrBM,tt as u};
