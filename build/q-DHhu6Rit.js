import{b as L,q as u,u as v,D as C,o as m,s as M,A as R,I as O,d as S,m as w,k as d,l as y,_hW as f}from"./q-Q7QTf1-t.js";import{_}from"./q-BKaOGYNW.js";import{B as j}from"./q-CXrtXnGn.js";import{L as V,M as x}from"./q-Cfw5b693.js";import"./q-R_PFgutd.js";import{u as z}from"./q-bWKQX6P2.js";import"./q-D3Ga_9CS.js";import"./q-CX_U-nEJ.js";import"./q-C6JuRMDH.js";import"./q-B-GNphMI.js";import"./q-DTPKyc3d.js";const A="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",U=1e4,Q=3,D=500;var q=function(e){return e[e.Login=1]="Login",e[e.Register=2]="Register",e[e.ResetPassword=3]="ResetPassword",e}({});const Oe=L(u(()=>_(()=>Promise.resolve().then(()=>F),void 0),"s_0Rh76rd95Gg")),B=()=>{const[e,t]=v();if(!window.turnstile||!t.value){e.updateStatus("error","unavailable");return}e.updateStatus("verifying");try{e.reset(t.value)}catch{e.updateStatus("error","start_failed")}},N=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_z2TWTmFJ7w4:B},Symbol.toStringTag,{value:"Module"})),W=()=>{const[e,t]=v();e.value=0,t.updateStatus("ready","")},$=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_bxQNEtdzLyM:W},Symbol.toStringTag,{value:"Module"})),G=e=>{e&&window.turnstile&&window.turnstile.reset(e)},H=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_j5mw0EB2RmU:G},Symbol.toStringTag,{value:"Module"})),K=e=>{C();const t=z(),r={1:t.config.verify.enable_login_verify,2:t.config.verify.enable_register_verify,3:t.config.verify.enable_reset_password_verify};if(!t.config.verify.turnstile_site_key||!r[e.type])return null;const o=m(),n=m(null),i=m(!1),a=m("loading"),T=m(""),p=m(0),c=m(""),s={reset:u(()=>_(()=>Promise.resolve().then(()=>H),void 0),"s_j5mw0EB2RmU"),remove:u(()=>_(()=>Promise.resolve().then(()=>ce),void 0),"s_6bzkg0mW0OQ"),updateStatus:u(()=>_(()=>Promise.resolve().then(()=>ne),void 0),"s_MHV8LSMwSKg",[T,p,a])},b=u(()=>_(()=>Promise.resolve().then(()=>N),void 0),"s_z2TWTmFJ7w4",[s,n]),P=u(()=>_(()=>Promise.resolve().then(()=>$),void 0),"s_bxQNEtdzLyM",[p,s]),h=u(()=>_(()=>Promise.resolve().then(()=>Y),void 0),"s_3DvyQ1PBUHM",[c,e,p,s]);M(u(()=>_(()=>Promise.resolve().then(()=>ue),void 0),"s_5grNoN9ZktU",[i,a,s,n])),R(u(()=>_(()=>Promise.resolve().then(()=>Z),void 0),"s_MK4UvaS03YQ",[e,i,s,n])),M(u(()=>_(()=>Promise.resolve().then(()=>le),void 0),"s_BCMMVpGh87Y",[o,t,h,c,e,p,i,s,n]));const g=O(u(()=>_(()=>Promise.resolve().then(()=>ie),void 0),"s_XLJhW0n2MMc",[b,P,a])),I={loading:`正在加载验证...`,verifying:`正在验证...`,verified:`验证完成`,ready:`点击以验证您不是机器人`,error:{default:`验证失败`,errors:{unavailable:`验证服务不可用`,start_failed:`启动验证失败`,load_failed:`加载验证服务失败`,timeout:`验证超时`,general:`验证失败`}}},k=O(u(()=>_(()=>Promise.resolve().then(()=>te),void 0),"s_pibPLwRbC5U",[T,a,I]));return S("div",{class:x("relative w-full",e.class)},null,[w(j,{type:"button",onClick$:g.value.onClick,get look(){return g.value.look},class:"w-full",get loading(){return g.value.loading},get disabled(){return g.value.disabled},children:[a.value==="verified"&&w(V,{class:"mr-2 h-4 w-4",[y]:{class:y}},3,"iA_0"),d(l=>l.value,[k])],[y]:{type:y,look:d(l=>l.value.look,[g]),class:y,loading:d(l=>l.value.loading,[g]),disabled:d(l=>l.value.disabled,[g])}},0,"iA_1"),S("div",{ref:o},{class:"invisible h-0",id:d(l=>l.id,[e])},null,3,null),S("input",null,{type:"hidden",name:d(l=>l.name,[e]),value:d((l,E)=>(E.value??"")||l.value,[c,e]),required:d(l=>l.required,[e]),disabled:d(l=>l.disabled,[e]),"aria-hidden":"true"},null,3,null)],1,"iA_2")},F=Object.freeze(Object.defineProperty({__proto__:null,s_0Rh76rd95Gg:K},Symbol.toStringTag,{value:"Module"})),J=e=>{const[t,r,o,n]=v();r.onChange$&&r.onChange$(e),t.value=e,e?(o.value=0,n.updateStatus("verified")):n.updateStatus("ready")},Y=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_3DvyQ1PBUHM:J},Symbol.toStringTag,{value:"Module"})),X=({track:e})=>{const[t,r,o,n]=v(),i=e(()=>t.value??"");r.value&&n.value&&window.turnstile&&i===""&&o.reset(n.value)},Z=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_MK4UvaS03YQ:X},Symbol.toStringTag,{value:"Module"})),ee=()=>{const[e,t,r]=v();if(t.value==="error"){const o=r.error;return e.value&&o.errors&&o.errors[e.value]?o.errors[e.value]:o.default}return r[t.value]},te=Object.freeze(Object.defineProperty({__proto__:null,s_pibPLwRbC5U:ee},Symbol.toStringTag,{value:"Module"})),re=(e,t)=>{const[r,o,n]=v();n.value=e,t!==void 0&&(r.value=t),e==="error"&&o.value<Q&&(o.value++,setTimeout(()=>{n.value==="error"&&(n.value="ready")},2e3))},ne=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_MHV8LSMwSKg:re},Symbol.toStringTag,{value:"Module"})),oe=async({track:e,cleanup:t})=>{const[r,o,n,i,a,T,p,c,s]=v();e(()=>p.value),e(()=>o.config.verify.turnstile_site_key),!(!p.value||!r.value||!window.turnstile)&&(s.value&&(await c.remove(s.value),s.value=null),s.value=window.turnstile.render(r.value,{sitekey:o.config.verify.turnstile_site_key,callback:b=>{n(b),i.value=b,T.value=0},"error-callback":b=>{c.updateStatus("error","general")},"expired-callback":()=>{n(""),i.value="",c.updateStatus("ready")},"timeout-callback":()=>{c.updateStatus("error","timeout")},size:"invisible","response-field":!1,"response-field-name":a.name||"cf-turnstile-response",action:`verify_${q[a.type].toLowerCase()}`}),t(async()=>{s.value&&(await c.remove(s.value),s.value=null)}))},le=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_BCMMVpGh87Y:oe},Symbol.toStringTag,{value:"Module"})),se=()=>{const[e,t,r]=v(),o=r.value==="verified"?"primary":r.value==="error"?"alert":"outline",n=["loading","verifying"].includes(r.value),i=r.value!=="ready"&&r.value!=="error",a=r.value==="error"?t:e;return{look:o,loading:n,disabled:i,onClick:a}},ie=Object.freeze(Object.defineProperty({__proto__:null,s_XLJhW0n2MMc:se},Symbol.toStringTag,{value:"Module"})),ae=()=>{const[e,t,r,o]=v();if(window.turnstile){e.value=!0,t.value="ready";return}const n=document.createElement("script");n.src=A,n.async=!0,n.defer=!0,n.onload=()=>{window.turnstile&&(e.value=!0,t.value="ready")},n.onerror=()=>{r.updateStatus("error","load_failed")},window.onloadTurnstileCallback=()=>{e.value=!0,t.value="ready"},document.body.appendChild(n);const i=setInterval(()=>{window.turnstile&&(e.value=!0,t.value="ready",clearInterval(i))},D),a=setTimeout(()=>{t.value==="loading"&&r.updateStatus("error","timeout")},U);return async()=>{clearTimeout(a),clearInterval(i),await r.remove(o.value),o.value=null}},ue=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_5grNoN9ZktU:ae},Symbol.toStringTag,{value:"Module"})),_e=e=>{e&&window.turnstile&&window.turnstile.remove(e)},ce=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_6bzkg0mW0OQ:_e},Symbol.toStringTag,{value:"Module"}));export{Oe as T,f as _hW,K as s_0Rh76rd95Gg,J as s_3DvyQ1PBUHM,ae as s_5grNoN9ZktU,_e as s_6bzkg0mW0OQ,oe as s_BCMMVpGh87Y,re as s_MHV8LSMwSKg,X as s_MK4UvaS03YQ,se as s_XLJhW0n2MMc,W as s_bxQNEtdzLyM,G as s_j5mw0EB2RmU,ee as s_pibPLwRbC5U,B as s_z2TWTmFJ7w4};
